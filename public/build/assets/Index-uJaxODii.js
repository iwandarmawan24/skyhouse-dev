import{d as p,j as e,a4 as q,a5 as ee,a6 as se,a7 as ae,u as ne,L as ie,P as re,S as ce,i as A,a8 as te,X as y,e as f}from"./vendor-BnbgrNvg.js";import{A as le}from"./AdminLayout-sVT0_NAf.js";import{c as oe,B as l}from"./Button-C9qRTbX8.js";import{C as P,a as de,b as me,c as L}from"./Card-Dup5Ukx4.js";import{I as pe}from"./Input-BiTaUmO9.js";import{L as k}from"./Label-D-CdDNeh.js";import{B as d}from"./Badge-C1TDCZWx.js";import{D as T,a as I,b as M,c as B,d as V,e as $}from"./Dialog-DwNRdUFJ.js";import{D as H,a as E,b as z,c as U,d as X,e as u}from"./dropdown-menu-lXoZTmiu.js";import{D as he}from"./DataTable-yfPzvdhL.js";import{createColumns as xe,ViewProductDialog as ue}from"./columns-Dmu6N2o8.js";import{L as ge}from"./LaravelPagination-Bdfsmqhv.js";import"./Table-G1IrKxy8.js";import"./Pagination-CjnCdGXL.js";const G=p.forwardRef(({className:m,...n},t)=>{const r=n.value||n.defaultValue||[0],_=Array.isArray(r)?r.length:1;return e.jsxs(q,{ref:t,className:oe("relative flex w-full touch-none select-none items-center",m),...n,children:[e.jsx(ee,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(se,{className:"absolute h-full bg-primary"})}),Array.from({length:_}).map((b,h)=>e.jsx(ae,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"},h))]})});G.displayName=q.displayName;function Ae({products:m,filters:n,filterOptions:t}){console.log("Component props:",{products:m,filters:n,filterOptions:t});const r={...t,priceRange:{min:Number(t?.priceRange?.min)||0,max:Number(t?.priceRange?.max)||1e11},cities:t?.cities||[],provinces:t?.provinces||[]},{flash:_}=ne().props,[b,h]=p.useState(null),[D,F]=p.useState(null),[J,j]=p.useState(!1),[a,C]=p.useState({types:n?.types?n.types.split(",").filter(Boolean):[],statuses:n?.statuses?n.statuses.split(",").filter(Boolean):[],cities:n?.cities?n.cities.split(",").filter(Boolean):[],provinces:n?.provinces?n.provinces.split(",").filter(Boolean):[],search:n?.search||"",min_price:n?.min_price||r.priceRange.min,max_price:n?.max_price||r.priceRange.max}),[x,w]=p.useState(()=>{const s=Number(n?.min_price)||r.priceRange.min,i=Number(n?.max_price)||r.priceRange.max;return console.log("Initial price range:",{min:s,max:i,safeFilterOptions:r,filters:n}),[s,i]});p.useEffect(()=>{const s=r.priceRange.min,i=r.priceRange.max;!isNaN(s)&&!isNaN(i)&&s<i&&w([Number(n?.min_price)||s,Number(n?.max_price)||i])},[r.priceRange.min,r.priceRange.max,n?.min_price,n?.max_price]);const K=s=>{console.log("Price range change:",s),Array.isArray(s)&&s.filter(c=>typeof c=="number"&&!isNaN(c)).length===s.length&&w(s)},Q=s=>{f.delete(`/admin/products/${s}`,{onSuccess:()=>{h(null)}})},R=(s,i)=>{const c={...a,[s]:i};C(c);const g={search:c.search,types:c.types.join(","),statuses:c.statuses.join(","),cities:c.cities.join(","),provinces:c.provinces.join(","),min_price:c.min_price,max_price:c.max_price};f.get("/admin/products",g,{preserveState:!0,preserveScroll:!0})},o=(s,i)=>{const c=a[s],g=c.includes(i)?c.filter(O=>O!==i):[...c,i];R(s,g)},W=()=>{const s=r.priceRange.min,i=r.priceRange.max;C({types:[],statuses:[],cities:[],provinces:[],search:"",min_price:s,max_price:i}),w([s,i]),f.get("/admin/products",{},{preserveState:!0,preserveScroll:!0})},v=(s,i)=>{const c=a[s].filter(g=>g!==i);R(s,c)},Y=()=>{const s={...a,min_price:x[0],max_price:x[1]};C(s);const i={search:s.search,types:s.types.join(","),statuses:s.statuses.join(","),cities:s.cities.join(","),provinces:s.provinces.join(","),min_price:s.min_price,max_price:s.max_price};f.get("/admin/products",i,{preserveState:!0,preserveScroll:!0}),j(!1)},N=s=>{const i=Number(s);return isNaN(i)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(i)},S=a.cities.length>0||a.provinces.length>0||a.min_price!==r.priceRange.min||a.max_price!==r.priceRange.max,Z=xe(h,F);return e.jsxs(le,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Products"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your property listings and inventory"})]}),e.jsx(l,{asChild:!0,children:e.jsxs(ie,{href:"/admin/products/create",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Add Product"]})})]}),e.jsxs(P,{children:[e.jsx(de,{children:e.jsx(me,{children:"Filters"})}),e.jsx(L,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(pe,{type:"text",placeholder:"Search by name, location, or city...",value:a.search,onChange:s=>R("search",s.target.value),className:"pl-10"})]})}),e.jsxs(H,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(l,{variant:"outline",className:"gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Type",a.types.length>0&&e.jsx(d,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:a.types.length})]})}),e.jsxs(z,{align:"end",className:"w-48",children:[e.jsx(U,{children:"Filter by Type"}),e.jsx(X,{}),e.jsx(u,{checked:a.types.includes("house"),onCheckedChange:()=>o("types","house"),children:"House"}),e.jsx(u,{checked:a.types.includes("apartment"),onCheckedChange:()=>o("types","apartment"),children:"Apartment"}),e.jsx(u,{checked:a.types.includes("land"),onCheckedChange:()=>o("types","land"),children:"Land"})]})]}),e.jsxs(H,{children:[e.jsx(E,{asChild:!0,children:e.jsxs(l,{variant:"outline",className:"gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Status",a.statuses.length>0&&e.jsx(d,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:a.statuses.length})]})}),e.jsxs(z,{align:"end",className:"w-48",children:[e.jsx(U,{children:"Filter by Status"}),e.jsx(X,{}),e.jsx(u,{checked:a.statuses.includes("active"),onCheckedChange:()=>o("statuses","active"),children:"Active"}),e.jsx(u,{checked:a.statuses.includes("sold"),onCheckedChange:()=>o("statuses","sold"),children:"Sold"}),e.jsx(u,{checked:a.statuses.includes("inactive"),onCheckedChange:()=>o("statuses","inactive"),children:"Inactive"})]})]}),e.jsxs(l,{variant:"outline",className:"gap-2",onClick:()=>j(!0),children:[e.jsx(te,{className:"h-4 w-4"}),"Advanced",S&&e.jsx(d,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:"âœ“"})]})]}),(a.types.length>0||a.statuses.length>0||a.cities.length>0||a.provinces.length>0||a.search||S)&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),a.types.map(s=>e.jsxs(d,{variant:"secondary",className:"gap-1",children:["Type: ",s.charAt(0).toUpperCase()+s.slice(1),e.jsx("button",{onClick:()=>v("types",s),className:"ml-1 hover:text-destructive",children:e.jsx(y,{className:"h-3 w-3"})})]},s)),a.statuses.map(s=>e.jsxs(d,{variant:"secondary",className:"gap-1",children:["Status: ",s.charAt(0).toUpperCase()+s.slice(1),e.jsx("button",{onClick:()=>v("statuses",s),className:"ml-1 hover:text-destructive",children:e.jsx(y,{className:"h-3 w-3"})})]},s)),a.cities.map(s=>e.jsxs(d,{variant:"secondary",className:"gap-1",children:["City: ",s,e.jsx("button",{onClick:()=>v("cities",s),className:"ml-1 hover:text-destructive",children:e.jsx(y,{className:"h-3 w-3"})})]},s)),a.provinces.map(s=>e.jsxs(d,{variant:"secondary",className:"gap-1",children:["Province: ",s,e.jsx("button",{onClick:()=>v("provinces",s),className:"ml-1 hover:text-destructive",children:e.jsx(y,{className:"h-3 w-3"})})]},s)),(a.min_price!==t.priceRange.min||a.max_price!==t.priceRange.max)&&e.jsxs(d,{variant:"secondary",className:"gap-1",children:["Price: ",N(a.min_price)," - ",N(a.max_price)]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:W,className:"h-6 px-2 text-xs",children:"Clear all"})]})]})})]}),e.jsx(P,{children:e.jsx(L,{className:"pt-6",children:e.jsx(he,{columns:Z,data:m.data||[]})})}),m.data&&m.data.length>0&&e.jsx(ge,{data:m})]}),e.jsx(T,{open:J,onOpenChange:j,children:e.jsxs(I,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(M,{children:[e.jsx(B,{children:"Advanced Filters"}),e.jsx(V,{children:"Refine your search with additional filters"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(k,{className:"text-base font-semibold",children:"Price Range"}),e.jsxs("div",{className:"space-y-3",children:[console.log("Rendering slider with:",{min:r.priceRange.min,max:r.priceRange.max,value:x}),e.jsx(G,{min:r.priceRange.min,max:r.priceRange.max,step:1e8,value:x,onValueChange:K,className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:N(x[0])}),e.jsx("span",{className:"text-muted-foreground",children:N(x[1])})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-base font-semibold",children:"City"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border rounded-md p-3",children:r.cities.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`city-${s}`,checked:a.cities.includes(s),onChange:()=>o("cities",s),className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:`city-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(k,{className:"text-base font-semibold",children:"Province"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:r.provinces.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`province-${s}`,checked:a.provinces.includes(s),onChange:()=>o("provinces",s),className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:`province-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})]})]}),e.jsxs($,{children:[e.jsx(l,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(l,{onClick:Y,children:"Apply Filters"})]})]})}),e.jsx(ue,{product:D,open:!!D,onOpenChange:()=>F(null)}),e.jsx(T,{open:!!b,onOpenChange:()=>h(null),children:e.jsxs(I,{children:[e.jsxs(M,{children:[e.jsx(B,{children:"Delete Product"}),e.jsx(V,{children:"Are you sure you want to delete this product? This action cannot be undone and will also delete all associated images."})]}),e.jsxs($,{children:[e.jsx(l,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),e.jsx(l,{variant:"destructive",onClick:()=>Q(b),children:"Delete"})]})]})})]})}export{Ae as default};
