import{d as m,j as e,y as C,a8 as Z,S as ee,z as se,F as ae,X as z,T as I,a4 as le,a9 as te,t as U,e as g,a as D,aa as x,ab as re,ac as ie,ad as ne}from"./vendor-CGGQDrpY.js";import{A as de}from"./AdminLayout-Q6Po-ppz.js";import{B as r,c as B}from"./Button-DtLeDkBC.js";import{C as i,a as h,b as u,c as n}from"./Card-B72U85z3.js";import{I as ce}from"./Input-vqcA0MAI.js";import{B as N}from"./Badge-Cq8sI8zv.js";import{D as _,a as L,b as A,c as E,d as P,e as oe}from"./Dialog-Be0ftsTY.js";import{D as H,a as O,b as V,c as $,d as q,e as b}from"./dropdown-menu-CYqC-BQh.js";import{L as me}from"./LaravelPagination-DQozvNKl.js";import"./Pagination-CmKTazYe.js";function Ce({media:o,folders:k,stats:p,filters:v}){const[F,f]=m.useState(null),[G,y]=m.useState(!1),[j,w]=m.useState([]),[S,M]=m.useState(!1),[xe,he]=m.useState(null),[a,T]=m.useState({type:v?.type||"",folder:v?.folder||"",search:v?.search||""}),d=(s,l)=>{const t={...a,[s]:l};T(t),g.get("/admin/media-library",t,{preserveState:!0,preserveScroll:!0})},K=()=>{T({type:"",folder:"",search:""}),g.get("/admin/media-library",{},{preserveState:!0,preserveScroll:!0})},R=async s=>{if(!s||s.length===0)return;M(!0);const l=new FormData;Array.from(s).forEach(t=>{l.append("files[]",t)});try{const t=await D.post("/admin/media-library/upload",l,{headers:{"Content-Type":"multipart/form-data"}});t.data.success&&(x.success(t.data.message),y(!1),g.reload())}catch{x.error("Upload failed. Please try again.")}finally{M(!1)}},X=async s=>{try{const l=await D.delete(`/admin/media-library/${s}`);l.data.success&&(x.success(l.data.message),f(null),g.reload())}catch(l){x.error(l.response?.data?.message||"Delete failed")}},J=async()=>{if(j.length!==0)try{const s=await D.post("/admin/media-library/bulk-delete",{media_uids:j});s.data.success&&(x.success(s.data.message),w([]),g.reload())}catch{x.error("Bulk delete failed")}},Q=s=>{w(l=>l.includes(s)?l.filter(t=>t!==s):[...l,s])},W=s=>{const l={image:U,video:ne,document:ie,default:re};return l[s]||l.default},Y=s=>{const l=["B","KB","MB","GB"];let t=s,c=0;for(;t>1024&&c<l.length-1;)t/=1024,c++;return`${t.toFixed(2)} ${l[c]}`};return e.jsxs(de,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Media Library"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage and organize your media files"})]}),e.jsxs(r,{onClick:()=>y(!0),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Upload Files"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(i,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Total Files"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.total})})]}),e.jsxs(i,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Images"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.images})})]}),e.jsxs(i,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Videos"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.videos})})]}),e.jsxs(i,{children:[e.jsx(h,{className:"pb-2",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Documents"})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:p.documents})})]}),e.jsxs(i,{children:[e.jsx(h,{className:"pb-2",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center",children:[e.jsx(Z,{className:"mr-1 h-4 w-4"}),"Storage Used"]})}),e.jsx(n,{children:e.jsx("div",{className:"text-2xl font-bold",children:Y(p.total_size)})})]})]}),e.jsxs(i,{children:[e.jsx(h,{children:e.jsx(u,{children:"Filters"})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(ce,{type:"text",placeholder:"Search media...",value:a.search,onChange:s=>d("search",s.target.value),className:"pl-10"})]})}),e.jsxs(H,{children:[e.jsx(O,{asChild:!0,children:e.jsxs(r,{variant:"outline",className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Type",a.type&&e.jsx(N,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:"1"})]})}),e.jsxs(V,{align:"end",className:"w-48",children:[e.jsx($,{children:"Filter by Type"}),e.jsx(q,{}),e.jsx(b,{checked:a.type==="image",onCheckedChange:()=>d("type",a.type==="image"?"":"image"),children:"Images"}),e.jsx(b,{checked:a.type==="video",onCheckedChange:()=>d("type",a.type==="video"?"":"video"),children:"Videos"}),e.jsx(b,{checked:a.type==="document",onCheckedChange:()=>d("type",a.type==="document"?"":"document"),children:"Documents"})]})]}),k.length>0&&e.jsxs(H,{children:[e.jsx(O,{asChild:!0,children:e.jsxs(r,{variant:"outline",className:"gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Folder",a.folder&&e.jsx(N,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:"1"})]})}),e.jsxs(V,{align:"end",className:"w-48",children:[e.jsx($,{children:"Filter by Folder"}),e.jsx(q,{}),k.map(s=>e.jsx(b,{checked:a.folder===s,onCheckedChange:()=>d("folder",a.folder===s?"":s),children:s},s))]})]})]}),(a.type||a.folder||a.search)&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),a.type&&e.jsxs(N,{variant:"secondary",className:"gap-1",children:["Type: ",a.type,e.jsx("button",{onClick:()=>d("type",""),className:"ml-1 hover:text-destructive",children:e.jsx(z,{className:"h-3 w-3"})})]}),a.folder&&e.jsxs(N,{variant:"secondary",className:"gap-1",children:["Folder: ",a.folder,e.jsx("button",{onClick:()=>d("folder",""),className:"ml-1 hover:text-destructive",children:e.jsx(z,{className:"h-3 w-3"})})]}),e.jsx(r,{variant:"ghost",size:"sm",onClick:K,className:"h-6 px-2 text-xs",children:"Clear all"})]})]})})]}),j.length>0&&e.jsx(i,{className:"bg-primary/5 border-primary",children:e.jsxs(n,{className:"py-3 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-medium",children:[j.length," item(s) selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>w([]),children:"Clear Selection"}),e.jsxs(r,{variant:"destructive",size:"sm",onClick:J,children:[e.jsx(I,{className:"mr-2 h-4 w-4"}),"Delete Selected"]})]})]})}),e.jsx(i,{children:e.jsx(n,{className:"pt-6",children:o.data&&o.data.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:o.data.map(s=>{const l=W(s.file_type),t=j.includes(s.uid);return e.jsxs("div",{className:B("relative aspect-square rounded-lg border-2 overflow-hidden cursor-pointer transition-all hover:shadow-md group",t?"border-primary ring-2 ring-primary ring-offset-2":"border-border hover:border-primary/50"),onClick:()=>Q(s.uid),children:[s.file_type==="image"?e.jsx("img",{src:s.thumbnail_url,alt:s.alt_text||s.filename,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted",children:e.jsx(l,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("div",{className:B("w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",t?"bg-primary border-primary":"bg-white border-gray-300 group-hover:border-primary"),children:t&&e.jsx(le,{className:"h-3 w-3 text-white"})})}),e.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[e.jsx(r,{variant:"secondary",size:"icon",className:"h-6 w-6",onClick:c=>{c.stopPropagation(),window.open(s.url,"_blank")},children:e.jsx(te,{className:"h-3 w-3"})}),e.jsx(r,{variant:"destructive",size:"icon",className:"h-6 w-6",onClick:c=>{c.stopPropagation(),f(s.uid)},children:e.jsx(I,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:[e.jsx("p",{className:"text-white text-xs truncate",children:s.filename}),e.jsx("p",{className:"text-white/70 text-xs",children:s.file_size_human})]})]},s.uid)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(U,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No media found"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:a.search||a.type||a.folder?"Try adjusting your filters":"Upload files to get started"}),!a.search&&!a.type&&!a.folder&&e.jsxs(r,{onClick:()=>y(!0),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Upload Files"]})]})})}),o.data&&o.data.length>0&&e.jsx(me,{data:o})]}),e.jsx(_,{open:G,onOpenChange:y,children:e.jsxs(L,{children:[e.jsxs(A,{children:[e.jsx(E,{children:"Upload Files"}),e.jsx(P,{children:"Select files to upload to your media library"})]}),e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-12 text-center",children:[e.jsx("input",{type:"file",id:"file-upload",multiple:!0,onChange:s=>R(s.target.files),className:"hidden",disabled:S}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(C,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:S?"Uploading...":"Click to upload"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Maximum file size: 10MB"})]})]})]})}),e.jsx(_,{open:!!F,onOpenChange:()=>f(null),children:e.jsxs(L,{children:[e.jsxs(A,{children:[e.jsx(E,{children:"Delete Media"}),e.jsx(P,{children:"Are you sure you want to delete this media file? This action cannot be undone."})]}),e.jsxs(oe,{children:[e.jsx(r,{variant:"outline",onClick:()=>f(null),children:"Cancel"}),e.jsx(r,{variant:"destructive",onClick:()=>X(F),children:"Delete"})]})]})})]})}export{Ce as default};
