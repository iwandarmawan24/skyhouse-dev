import{d as o,j as e,aa as Y,ab as ue,ac as xe,ad as he,ae as ge,af as je,ag as fe,ah as Z,ai as K,aj as O,ak as ee,al as se,a5 as ve,am as ae,an as Ne,ao as te,ap as ne,aq as ie,ar as ye,as as be,at as L,au as we,av as Ce,aw as Re,ax as Se,u as ke,L as Pe,P as Fe,S as De,ay as B,az as _e,X as R,e as S}from"./vendor-ERzRPhBn.js";import{A as Me}from"./AdminLayout-BzYBBHe-.js";import{c as u,B as p}from"./Button-DKkj-eXv.js";import{C as V,a as Te,b as Ae,c as H}from"./Card-BAS-lTRp.js";import{I as re}from"./Input-6qSCy0Tm.js";import{L as F}from"./Label-bwIrahzs.js";import{B as g}from"./Badge-B7vNS-mb.js";import{D as $,a as E,b as U,c as q,d as X,e as G}from"./Dialog-BX14YzQf.js";import{T as Ie,a as ze,b as D,c as Le,d as Be,e as J}from"./Table-BJHOxjky.js";import{P as Ve,a as He,b as _,c as $e,d as Ee,e as Ue}from"./Pagination-BoFrHyhw.js";import{createColumns as qe,ViewProductDialog as Xe}from"./columns-9-6poFaE.js";const le=o.forwardRef(({className:i,...n},t)=>e.jsxs(Y,{ref:t,className:u("relative flex w-full touch-none select-none items-center",i),...n,children:[e.jsx(ue,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:e.jsx(xe,{className:"absolute h-full bg-primary"})}),e.jsx(he,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));le.displayName=Y.displayName;const Q=ge,W=je,Ge=o.forwardRef(({className:i,inset:n,children:t,...c},x)=>e.jsxs(ae,{ref:x,className:u("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",n&&"pl-8",i),...c,children:[t,e.jsx(Ne,{className:"ml-auto"})]}));Ge.displayName=ae.displayName;const Je=o.forwardRef(({className:i,...n},t)=>e.jsx(te,{ref:t,className:u("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",i),...n}));Je.displayName=te.displayName;const M=o.forwardRef(({className:i,sideOffset:n=4,...t},c)=>e.jsx(fe,{children:e.jsx(Z,{ref:c,sideOffset:n,className:u("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",i),...t})}));M.displayName=Z.displayName;const Qe=o.forwardRef(({className:i,inset:n,...t},c)=>e.jsx(ne,{ref:c,className:u("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",n&&"pl-8",i),...t}));Qe.displayName=ne.displayName;const j=o.forwardRef(({className:i,children:n,checked:t,...c},x)=>e.jsxs(ee,{ref:x,className:u("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",i),checked:t,...c,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(se,{children:e.jsx(ve,{className:"h-4 w-4"})})}),n]}));j.displayName=ee.displayName;const We=o.forwardRef(({className:i,children:n,...t},c)=>e.jsxs(ie,{ref:c,className:u("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",i),...t,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(se,{children:e.jsx(ye,{className:"h-2 w-2 fill-current"})})}),n]}));We.displayName=ie.displayName;const T=o.forwardRef(({className:i,inset:n,...t},c)=>e.jsx(K,{ref:c,className:u("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",i),...t}));T.displayName=K.displayName;const A=o.forwardRef(({className:i,...n},t)=>e.jsx(O,{ref:t,className:u("-mx-1 my-1 h-px bg-muted",i),...n}));A.displayName=O.displayName;function Ye({columns:i,data:n,searchKey:t,searchPlaceholder:c="Search..."}){const[x,f]=o.useState([]),[y,b]=o.useState([]),r=be({data:n,columns:i,getCoreRowModel:Se(),getPaginationRowModel:Re(),onSortingChange:f,getSortedRowModel:Ce(),onColumnFiltersChange:b,getFilteredRowModel:we(),initialState:{pagination:{pageSize:5}},state:{sorting:x,columnFilters:y}});return e.jsxs("div",{className:"space-y-4",children:[t&&e.jsx("div",{className:"flex items-center",children:e.jsx(re,{placeholder:c,value:r.getColumn(t)?.getFilterValue()??"",onChange:l=>r.getColumn(t)?.setFilterValue(l.target.value),className:"max-w-sm"})}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ie,{children:[e.jsx(ze,{children:r.getHeaderGroups().map(l=>e.jsx(D,{children:l.headers.map(a=>e.jsx(Le,{children:a.isPlaceholder?null:L(a.column.columnDef.header,a.getContext())},a.id))},l.id))}),e.jsx(Be,{children:r.getRowModel().rows?.length?r.getRowModel().rows.map(l=>e.jsx(D,{"data-state":l.getIsSelected()&&"selected",children:l.getVisibleCells().map(a=>e.jsx(J,{children:L(a.column.columnDef.cell,a.getContext())},a.id))},l.id)):e.jsx(D,{children:e.jsx(J,{colSpan:i.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",r.getState().pagination.pageIndex*r.getState().pagination.pageSize+1," to"," ",Math.min((r.getState().pagination.pageIndex+1)*r.getState().pagination.pageSize,r.getFilteredRowModel().rows.length)," ","of ",r.getFilteredRowModel().rows.length," results"]}),e.jsx(Ve,{children:e.jsxs(He,{children:[e.jsx(_,{children:e.jsx($e,{onClick:()=>r.previousPage(),disabled:!r.getCanPreviousPage(),className:r.getCanPreviousPage()?"cursor-pointer":"pointer-events-none opacity-50"})}),Array.from({length:r.getPageCount()},(l,a)=>a).map(l=>e.jsx(_,{children:e.jsx(Ee,{onClick:()=>r.setPageIndex(l),isActive:r.getState().pagination.pageIndex===l,className:"cursor-pointer",children:l+1})},l)),e.jsx(_,{children:e.jsx(Ue,{onClick:()=>r.nextPage(),disabled:!r.getCanNextPage(),className:r.getCanNextPage()?"cursor-pointer":"pointer-events-none opacity-50"})})]})})]})]})}function os({products:i,filters:n,filterOptions:t}){const{flash:c}=ke().props,[x,f]=o.useState(null),[y,b]=o.useState(null),[r,l]=o.useState(!1),[a,k]=o.useState({types:n?.types?n.types.split(",").filter(Boolean):[],statuses:n?.statuses?n.statuses.split(",").filter(Boolean):[],cities:n?.cities?n.cities.split(",").filter(Boolean):[],provinces:n?.provinces?n.provinces.split(",").filter(Boolean):[],search:n?.search||"",min_price:n?.min_price||t.priceRange.min,max_price:n?.max_price||t.priceRange.max}),[v,I]=o.useState([Number(n?.min_price||t.priceRange.min),Number(n?.max_price||t.priceRange.max)]),oe=s=>{S.delete(`/admin/products/${s}`,{onSuccess:()=>{f(null)}})},P=(s,m)=>{const d={...a,[s]:m};k(d);const N={search:d.search,types:d.types.join(","),statuses:d.statuses.join(","),cities:d.cities.join(","),provinces:d.provinces.join(","),min_price:d.min_price,max_price:d.max_price};S.get("/admin/products",N,{preserveState:!0,preserveScroll:!0})},h=(s,m)=>{const d=a[s],N=d.includes(m)?d.filter(pe=>pe!==m):[...d,m];P(s,N)},ce=()=>{k({types:[],statuses:[],cities:[],provinces:[],search:"",min_price:t.priceRange.min,max_price:t.priceRange.max}),I([t.priceRange.min,t.priceRange.max]),S.get("/admin/products",{},{preserveState:!0,preserveScroll:!0})},w=(s,m)=>{const d=a[s].filter(N=>N!==m);P(s,d)},de=()=>{const s={...a,min_price:v[0],max_price:v[1]};k(s);const m={search:s.search,types:s.types.join(","),statuses:s.statuses.join(","),cities:s.cities.join(","),provinces:s.provinces.join(","),min_price:s.min_price,max_price:s.max_price};S.get("/admin/products",m,{preserveState:!0,preserveScroll:!0}),l(!1)},C=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),z=a.cities.length>0||a.provinces.length>0||a.min_price!==t.priceRange.min||a.max_price!==t.priceRange.max,me=qe(f,b);return e.jsxs(Me,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Products"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your property listings and inventory"})]}),e.jsx(p,{asChild:!0,children:e.jsxs(Pe,{href:"/admin/products/create",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Add Product"]})})]}),e.jsxs(V,{children:[e.jsx(Te,{children:e.jsx(Ae,{children:"Filters"})}),e.jsx(H,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(re,{type:"text",placeholder:"Search by name, location, or city...",value:a.search,onChange:s=>P("search",s.target.value),className:"pl-10"})]})}),e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Type",a.types.length>0&&e.jsx(g,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:a.types.length})]})}),e.jsxs(M,{align:"end",className:"w-48",children:[e.jsx(T,{children:"Filter by Type"}),e.jsx(A,{}),e.jsx(j,{checked:a.types.includes("house"),onCheckedChange:()=>h("types","house"),children:"House"}),e.jsx(j,{checked:a.types.includes("apartment"),onCheckedChange:()=>h("types","apartment"),children:"Apartment"}),e.jsx(j,{checked:a.types.includes("land"),onCheckedChange:()=>h("types","land"),children:"Land"})]})]}),e.jsxs(Q,{children:[e.jsx(W,{asChild:!0,children:e.jsxs(p,{variant:"outline",className:"gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),"Status",a.statuses.length>0&&e.jsx(g,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:a.statuses.length})]})}),e.jsxs(M,{align:"end",className:"w-48",children:[e.jsx(T,{children:"Filter by Status"}),e.jsx(A,{}),e.jsx(j,{checked:a.statuses.includes("active"),onCheckedChange:()=>h("statuses","active"),children:"Active"}),e.jsx(j,{checked:a.statuses.includes("sold"),onCheckedChange:()=>h("statuses","sold"),children:"Sold"}),e.jsx(j,{checked:a.statuses.includes("inactive"),onCheckedChange:()=>h("statuses","inactive"),children:"Inactive"})]})]}),e.jsxs(p,{variant:"outline",className:"gap-2",onClick:()=>l(!0),children:[e.jsx(_e,{className:"h-4 w-4"}),"Advanced",z&&e.jsx(g,{variant:"secondary",className:"ml-1 rounded-full px-1.5 py-0",children:"âœ“"})]})]}),(a.types.length>0||a.statuses.length>0||a.cities.length>0||a.provinces.length>0||a.search||z)&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),a.types.map(s=>e.jsxs(g,{variant:"secondary",className:"gap-1",children:["Type: ",s.charAt(0).toUpperCase()+s.slice(1),e.jsx("button",{onClick:()=>w("types",s),className:"ml-1 hover:text-destructive",children:e.jsx(R,{className:"h-3 w-3"})})]},s)),a.statuses.map(s=>e.jsxs(g,{variant:"secondary",className:"gap-1",children:["Status: ",s.charAt(0).toUpperCase()+s.slice(1),e.jsx("button",{onClick:()=>w("statuses",s),className:"ml-1 hover:text-destructive",children:e.jsx(R,{className:"h-3 w-3"})})]},s)),a.cities.map(s=>e.jsxs(g,{variant:"secondary",className:"gap-1",children:["City: ",s,e.jsx("button",{onClick:()=>w("cities",s),className:"ml-1 hover:text-destructive",children:e.jsx(R,{className:"h-3 w-3"})})]},s)),a.provinces.map(s=>e.jsxs(g,{variant:"secondary",className:"gap-1",children:["Province: ",s,e.jsx("button",{onClick:()=>w("provinces",s),className:"ml-1 hover:text-destructive",children:e.jsx(R,{className:"h-3 w-3"})})]},s)),(a.min_price!==t.priceRange.min||a.max_price!==t.priceRange.max)&&e.jsxs(g,{variant:"secondary",className:"gap-1",children:["Price: ",C(a.min_price)," - ",C(a.max_price)]}),e.jsx(p,{variant:"ghost",size:"sm",onClick:ce,className:"h-6 px-2 text-xs",children:"Clear all"})]})]})})]}),e.jsx(V,{children:e.jsx(H,{className:"pt-6",children:e.jsx(Ye,{columns:me,data:i.data||[]})})})]}),e.jsx($,{open:r,onOpenChange:l,children:e.jsxs(E,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(U,{children:[e.jsx(q,{children:"Advanced Filters"}),e.jsx(X,{children:"Refine your search with additional filters"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(F,{className:"text-base font-semibold",children:"Price Range"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(le,{min:t.priceRange.min,max:t.priceRange.max,step:1e8,value:v,onValueChange:I,className:"w-full"}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:C(v[0])}),e.jsx("span",{className:"text-muted-foreground",children:C(v[1])})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(F,{className:"text-base font-semibold",children:"City"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border rounded-md p-3",children:t.cities.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`city-${s}`,checked:a.cities.includes(s),onChange:()=>h("cities",s),className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:`city-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(F,{className:"text-base font-semibold",children:"Province"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.provinces.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`province-${s}`,checked:a.provinces.includes(s),onChange:()=>h("provinces",s),className:"h-4 w-4 rounded border-gray-300"}),e.jsx("label",{htmlFor:`province-${s}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})]})]}),e.jsxs(G,{children:[e.jsx(p,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsx(p,{onClick:de,children:"Apply Filters"})]})]})}),e.jsx(Xe,{product:y,open:!!y,onOpenChange:()=>b(null)}),e.jsx($,{open:!!x,onOpenChange:()=>f(null),children:e.jsxs(E,{children:[e.jsxs(U,{children:[e.jsx(q,{children:"Delete Product"}),e.jsx(X,{children:"Are you sure you want to delete this product? This action cannot be undone and will also delete all associated images."})]}),e.jsxs(G,{children:[e.jsx(p,{variant:"outline",onClick:()=>f(null),children:"Cancel"}),e.jsx(p,{variant:"destructive",onClick:()=>oe(x),children:"Delete"})]})]})})]})}export{os as default};
